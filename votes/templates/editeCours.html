{% extends "base1.html" %}

{% block mesactions %}
<ul>
  {% if user.is_superuser %}
  <li><a href="/votes/addEleves">Élèves</a></li>
  <li><a href="/votes/addProfs">Profs</a></li>
  <li><a href="/votes/addFormation">Formations d'AP<!-- ' --></a></li>
  <li><a href="/votes/lesCours">Séances d'AP<!-- ' --></a></li>
  <li><a href="/votes/cop">Élèves -> COPs</a></li>
  <li><hr/></li>
  <li><a href="/admin/">Administration directe de Django</a></li>
  {% else %}
  <!-- actions pour le non-administrateur -->
  {% endif %}
  <li><hr/></li>
  <li><a href="/logout">Déconnexion</a></li>
</ul>
{% endblock %}

{% block localscripts %}
<script type"text/javascript">
$(document).ready(function() {
    if("{{avertissement}}".length > 0){
	$( "#message" ).empty();
	$( "#message" ).attr({title: "Avertissement",});
	$( "#message" ).html("{{avertissement|safe}}");
	$( "#message" ).dialog({
	    modal: true,
	    buttons: [
		{
		    text: "OK",
		    click: function() {
			$( this ).dialog( "close" );
		    }
		}
	    ]
	});
    }

    var pdi=$("#id_public_designe_initial");
    var pdn=$("#id_public_designe");
    // force la boîte à cocher visible à la valeur du champ invisible
    pdn.prop("checked", pdi.val()=="True");

    // diminue la largeur des champs numériques
    $("#id_duree").css({width: "50px"});
    $("#id_capacite").css({width: "50px"});
});

</script>
{% endblock %}

{% block title %}
<h1>Modification d'un cours ({{prof.nom}} {{prof.prenom}} -- {{horaire}})</h1> <!-- ' -->
{% endblock %}

{% block contents %}
<form method="post">
<table border="1" class="joli">
  <tr class="fieldWrapper">
    <td>
      <label for="{{form.titre.id_for_label}}">
	Description courte :
      </label>
    </td>
    <td>
      {{form.titre}}
    </td>
  </tr>
  <tr class="fieldWrapper">
    <td>
      <label for="{{form.contenu.id_for_label}}">
	Description longue :
      </label>
    </td>
    <td>
      {{form.contenu}}
    </td>
  </tr>
  <tr class="fieldWrapper">
    <td colspan="2">
      <div id="smallFields">
	<div style="display: inline-block; float: left; width: 300px; margin-right: auto;">
	  {% if form.duree.errors %}{{ form.duree.errors }}<br/>{% endif %}
	  <label for="{{form.duree.id_for_label}}">
	    Durée (1 ou 2 heures) :
	  </label>
	  {{form.duree}}
	</div>
	<div style="display: inline-block; width: 300px; margins: auto 0;">
	  {% if form.capacite.errors %}{{ form.capacite.errors }}<br/>{% endif %}
	  <label for="{{form.capacite.id_for_label}}">
	    capacité (±18 élèves) :
	  </label>
	  {{form.capacite}}
	</div>
	<div style="display: inline-block; float:right;">
	  {% if form.public_designe.errors %}{{ form.public_designe.errors }}<br/>{% endif %}
	  <label for="{{form.public_designe.id_for_label}}">
	    Public désigné :
	  </label>
	  {{form.public_designe}}
	</div>
      </div>
      <div id="hiddenFields">
      <input type="hidden" name="c_id" id="c_id" value="{{c_id}}"/>
      {{form.back}} {{form.is_superuser}} {{form.public_designe_initial}}
      </div>
      {% csrf_token %}
    </td>
  </tr>
</table>
<input type="submit" value="Valider les modifications" style="margin: 1em;"/>
{{ form.non_field_errors }}
</form>
<div id="message"></div>
{% endblock %}
